---
title: "hw-03"
author: "Beth (S2852258)"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
## **DO NOT EDIT THIS CODE CHUNK**
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(tidymodels)
```


## Data load and preparation before modelling

```{r read_data}
gss16<-read.csv("data/gss16.csv")
```

#### Cleaning and selecting columns

```{r}
gss16_advfront <- gss16 %>%
  select(advfront, emailhr, educ, polviews, wrkstat) %>%
  drop_na()
```

#### Re-levelling `advfront`

```{r}
gss16_advfront <- gss16_advfront %>%
  mutate(
    advfront = case_when(
      advfront == "Strongly agree" ~ "Agree",
      advfront == "Agree" ~ "Agree",
      TRUE ~ "Not agree"
    ),
    advfront = fct_relevel(advfront, "Not agree", "Agree")
  )
```

#### Re-levelling `polviews`

```{r}
gss16_advfront <- gss16_advfront %>%
  mutate(
    polviews = case_when(
      str_detect(polviews, "[Cc]onservative") ~ "Conservative",
      str_detect(polviews, "[Ll]iberal") ~ "Liberal",
      TRUE ~ polviews
    ),
    polviews = fct_relevel(polviews, "Conservative", "Moderate", "Liberal")
  )
```


## Exercise 1: Create a linear regression model

#### Exercise 1 (a)

```{r}
linear_reg() %>%
  set_engine("lm")%>%
  fit(educ ~ emailhr, data = gss16_advfront) %>%
  tidy()
```

*Line of best fit formula: Å· = 13.7 + 0.04x. This means that the estimate for the mean value of emailhr is 14.1*

#### Exercise 1 (b)

```{r}
ggplot(data = gss16_advfront,
       mapping = aes( x = educ,
                      y = emailhr)) +
  geom_point()+
  geom_smooth(method = lm, se = FALSE)

```

*Your answer here*

## Exercise 2: Create a workflow to fit a model

```{r split-data}
set.seed(1234)
gss16_split <- initial_split(gss16_advfront)
gss16_train <- training(gss16_split)
gss16_test  <- testing(gss16_split)
```

#### Exercise 2 (a)

```{r}
gss16_rec_1 <- recipe(educ ~ advfront, data = gss16_train)
  
gss16_mod_1 <- linear_reg() %>%
  set_engine("lm")

gss16_wflow_1 <- workflow() %>%
  add_model(gss16_mod_1) %>%
  add_recipe(gss16_rec_1)
```

*Your answer here*

#### Exercise 2 (b)

```{r}
# replace this with your code
```

*Your answer here*

#### Exercise 2 (c)

```{r}
# replace this with your code
```

*Your answer here*

## Exercise 3: Logistic regression with single predictor

#### Exercise 3 (a)

```{r}
# replace this with your code
```

*Your answer here*

#### Exercise 3 (b)

```{r}
# replace this with your code
```

*Your answer here*

## Exercise 4: Logistic regression modelling and interpretation

#### Exercise 4 (a)

```{r}
# replace this with your code
```

*Your answer here*

#### Exercise 4 (b)
  
```{r}
# replace this with your code
```

*Your answer here*

#### Exercise 4 (c) 

```{r}
# replace this with your code
```

*Your answer here*

